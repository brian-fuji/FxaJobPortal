@page "/transactions"

@inherits TransactionsRadzenBase;
@using RestClient.Net;
@using Models;
@using Radzen.Blazor
@using Radzen;
@using Newtonsoft.Json;
@using System.Net.Http.Headers;
@using FxaPortal.Services;

<Row>
    <Column>
        <Card Margin="Margin.Is4.OnY">
            <CardHeader>
                <CardTitle>Transactions</CardTitle>
            </CardHeader>
            <CardBody>
                <Row Margin="Margin.Is1.FromBottom">
                    <Column ColumnSize="ColumnSize.Is12">
                        <RadzenButton  Click="@RefreshData" Text="Refresh" Icon="@refreshIcon" Style="margin-bottom: 5px; width:120px; float: right"></RadzenButton>
                    </Column>
                </Row>
                <Row>
                    <Column>
                        <RadzenGrid Count="@count"
                                    Data="@transactionList"
                                    LoadData="@LoadData"
                                    AllowSorting="true"
                                    AllowFiltering="true"
                                    AllowPaging="true"
                                    PageSize="15"
                                    TItem="Transaction"
                                    ColumnWidth="200px"
                                    RowSelect="@OnRowSelected">
                            <Columns>
                                <RadzenGridColumn TItem="Transaction" Property="DocumentId" Title="Id" Visible="true" Width="50px" />
                                <RadzenGridColumn TItem="Transaction" Property="BatchRunNumber" Title="Run #"  Width="80px"/>
                                <RadzenGridColumn TItem="Transaction" Property="BatchAbbr" Title="Batch Type" />
                                <RadzenGridColumn TItem="Transaction" Property="TransactionType" Title="Transaction Type" Width="100px" />
                                <RadzenGridColumn TItem="Transaction" Property="IssueDate" Title="Issue Date" />
                                <RadzenGridColumn TItem="Transaction" Property="PolicyNumber" Title="Policy Number" />
                                <RadzenGridColumn TItem="Transaction" Property="CoverType" Title="Covertype" />
                                <RadzenGridColumn TItem="Transaction" Property="NoticeType" Title="Notice Type" />
                                <RadzenGridColumn TItem="Transaction" Property="Status" Title="Status" />
                                <RadzenGridColumn TItem="Transaction" Property="TransactionDate" Title="Transaction Date" />

                            </Columns>
                        </RadzenGrid>
                    </Column>
                </Row>
            </CardBody>
        </Card>
    </Column>
</Row>
<Row>
    <Column>
        <RadzenButton Icon="" style="margin-bottom: 10px" Text="View Metadata" Click="@ViewMetadataClicked" Disabled="selectedTransaction == null">
        </RadzenButton>
    </Column>
</Row>
<Row>
    <Column>
        <Card Margin="Margin.Is4.OnY">
            <CardHeader>
                <CardTitle>Metadata</CardTitle>
            </CardHeader>
            <CardBody>
                <RadzenTextArea Rows="15" Style="width: 100%" @bind-Value="@currentMetaData"></RadzenTextArea>
            </CardBody>
        </Card>
    </Column>
</Row>

@code {
}

